apiVersion: mongodb.keiailab.com/v1alpha1
kind: MongoDBSharded
metadata:
  name: mongodb-sharded
  namespace: db
spec:
  version:
    version: "8.2"
  configServer:
    members: 3
    storage:
      size: 10Gi
      storageClassName: ceph-block
    resources:
      requests:
        cpu: 500m
        memory: 1Gi
      limits:
        cpu: 1000m
        memory: 2Gi
  shards:
    count: 3
    membersPerShard: 2
    storage:
      size: 1Ti
      storageClassName: ceph-block
    resources:
      requests:
        cpu: 1000m
        memory: 4Gi
      limits:
        cpu: 2000m
        memory: 8Gi
  mongos:
    replicas: 2
    resources:
      requests:
        cpu: 500m
        memory: 1Gi
      limits:
        cpu: 1000m
        memory: 2Gi
  auth:
    adminCredentialsSecretRef:
      name: mongodb-admin-creds
    mechanism: SCRAM-SHA-256
  monitoring:
    enabled: true
    exporter:
      image: percona/mongodb_exporter:0.40
