---
# MongoDB 백업 샘플 (수동 백업)
apiVersion: mongodb.keiailab.com/v1alpha1
kind: MongoDBBackup
metadata:
  name: my-mongodb-backup-manual
  namespace: database
spec:
  # 대상 클러스터 참조
  clusterRef:
    name: my-mongodb
    kind: MongoDB

  # 백업 타입
  type: full

  # 압축 설정
  compression: true
  compressionType: zstd

  # 저장소 설정 (S3/Ceph ObjectStore)
  storage:
    type: s3
    s3:
      bucket: mongodb-backups
      endpoint: http://ceph-objectstore.rook-ceph.svc:80
      region: us-east-1
      credentialsRef:
        name: ceph-objectstore-credentials
      prefix: mongodb/manual-backups/
      insecureSkipTLS: true
---
# Sharded Cluster 백업 샘플
apiVersion: mongodb.keiailab.com/v1alpha1
kind: MongoDBBackup
metadata:
  name: my-sharded-backup-manual
  namespace: database
spec:
  clusterRef:
    name: my-sharded
    kind: MongoDBSharded

  type: full
  compression: true
  compressionType: gzip

  storage:
    type: s3
    s3:
      bucket: mongodb-backups
      endpoint: http://ceph-objectstore.rook-ceph.svc:80
      credentialsRef:
        name: ceph-objectstore-credentials
      prefix: mongodb/sharded-backups/
---
# PVC 기반 백업 샘플
apiVersion: mongodb.keiailab.com/v1alpha1
kind: MongoDBBackup
metadata:
  name: my-mongodb-backup-pvc
  namespace: database
spec:
  clusterRef:
    name: my-mongodb
    kind: MongoDB

  type: full
  compression: true
  compressionType: gzip

  storage:
    type: pvc
    pvc:
      storageClassName: ceph-filesystem
      size: 100Gi
---
# S3 자격증명 Secret (Ceph ObjectStore용)
apiVersion: v1
kind: Secret
metadata:
  name: ceph-objectstore-credentials
  namespace: database
type: Opaque
stringData:
  access-key: "your-access-key"
  secret-key: "your-secret-key"
