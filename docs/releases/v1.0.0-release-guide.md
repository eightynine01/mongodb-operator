# MongoDB Operator v1.0.0 Release Guide

This guide provides step-by-step instructions for creating the v1.0.0 stable (GA) release of the MongoDB Operator.

## Table of Contents

- [Pre-Release Checklist](#pre-release-checklist)
- [Release Process](#release-process)
  - [1. Update Version Files](#1-update-version-files)
  - [2. Update CHANGELOG](#2-update-changelog)
  - [3. Create Git Tag](#3-create-git-tag)
  - [4. Build and Push Docker Images](#4-build-and-push-docker-images)
  - [5. Build and Publish Helm Chart](#5-build-and-publish-helm-chart)
  - [6. Build Cross-Platform Binaries](#6-build-cross-platform-binaries)
  - [7. Create GitHub Release](#7-create-github-release)
  - [8. Verification](#8-verification)
  - [9. Post-Release Tasks](#9-post-release-tasks)
- [Troubleshooting](#troubleshooting)
- [Future Releases](#future-releases)

---

## Pre-Release Checklist

Before creating the v1.0.0 release, verify the following items:

- [ ] **Code Quality**
  - [ ] All CI/CD workflows pass on main branch
  - [ ] Code coverage meets threshold (>= 80%)
  - [ ] No security vulnerabilities in dependencies
  - [ ] Pre-commit hooks pass on all changed files
  - [ ] `golangci-lint` reports no issues

- [ ] **Documentation**
  - [ ] CHANGELOG.md updated with v1.0.0 section
  - [ ] README.md reflects current state
  - [ ] All example files tested and working
  - [ ] Documentation links are valid
  - [ ] Contributing guidelines are current

- [ ] **Testing**
  - [ ] Unit tests pass: `make test`
  - [ ] Integration tests pass: `make integration-test`
  - [ ] Helm chart tested in test cluster: `helm install --dry-run`
  - [ ] Manual smoke tests completed
  - [ ] Known issues documented

- [ ] **Configuration**
  - [ ] Chart.yaml version updated to 1.0.0
  - [ ] appVersion updated to 1.0.0
  - [ ] Artifact Hub annotations updated
  - [ ] Docker image tag references updated
  - [ ] Version links in CHANGELOG updated

- [ ] **Security**
  - [ ] Latest Go version (1.25.0) used
  - [ ] Container images use immutable digests
  - [ ] SBOM and Provenance attestations enabled
  - [ ] License scan passes
  - [ ] CVE scan passes (Trivy)

- [ ] **Release Infrastructure**
  - [ ] Docker Hub access configured
  - [ ] GitHub token for release workflow
  - [ ] gh-pages branch exists
  - [ ] Artifact Hub publisher ID verified
  - [ ] Codecov token configured

---

## Release Process

### 1. Update Version Files

Version files are already updated in this release:

âœ… **CHANGELOG.md**: v1.0.0 section added with comprehensive release notes
âœ… **charts/mongodb-operator/Chart.yaml**: version and appVersion set to 1.0.0
âœ… **Artifact Hub annotations**: updated with v1.0.0 changes

**Verification:**
```bash
# Check Chart.yaml version
grep -A 2 "^version:" charts/mongodb-operator/Chart.yaml

# Check CHANGELOG has v1.0.0 section
grep -A 5 "## \[1.0.0\]" CHANGELOG.md
```

---

### 2. Update CHANGELOG

The CHANGELOG.md has been updated with:
- v1.0.0 section at the beginning
- Release date (2026-01-21)
- Summary of the release
- New features list (comprehensive CI/CD, documentation, examples)
- Breaking changes section (none)
- Updated version links at the bottom

**Verification:**
```bash
# Verify CHANGELOG format
head -50 CHANGELOG.md
```

---

### 3. Create Git Tag

Create an annotated tag for the release:

```bash
# Ensure you're on main branch with latest changes
git checkout main
git pull origin main

# Create annotated tag
git tag -a v1.0.0 -m "Initial stable release v1.0.0

Comprehensive GA release with:
- GitHub repository templates (Issues, PR)
- GitHub Actions CI/CD (5 workflows)
- Comprehensive documentation (9 docs)
- Production-ready examples (7 examples)
- Artifact Hub integration
- Dependency automation (Dependabot)
- Pre-commit hooks for code quality
- Code coverage with Codecov
- Helm repository publishing
- Security scanning (dependencies, containers, licenses)"

# Verify tag
git tag -l -n9 v1.0.0

# Show tag details
git show v1.0.0
```

**Do NOT push the tag yet** - it will be pushed as part of the GitHub release creation (step 7).

---

### 4. Build and Push Docker Images

Build multi-architecture Docker images and push to Docker Hub.

#### 4.1 Configure Environment

```bash
# Set version variables
export VERSION=v1.0.0
export REGISTRY=eightynine01
export IMAGE_NAME=mongodb-operator
export FULL_IMAGE=${REGISTRY}/${IMAGE_NAME}:${VERSION}

# Verify Docker login
docker info | grep Username
```

#### 4.2 Build Multi-Architecture Image

```bash
# Build and push multi-arch image (linux/amd64, linux/arm64)
docker buildx build \
  --platform linux/amd64,linux/arm64 \
  --push \
  -t ${FULL_IMAGE} \
  -t ${REGISTRY}/${IMAGE_NAME}:latest \
  --provenance=mode=max \
  --sbom=true \
  .

# Verify images exist
docker buildx imagetools inspect ${FULL_IMAGE}
```

#### 4.3 Generate SBOM and Provenance

The `--provenance=mode=max --sbom=true` flags automatically generate:

- **SBOM (Software Bill of Materials)**: Lists all dependencies and packages
- **Provenance**: Cryptographic signatures attesting to build integrity

**Verification:**
```bash
# Pull and verify image
docker pull ${FULL_IMAGE}
docker inspect ${FULL_IMAGE} | grep -A 5 "Architecture"

# Test image locally
docker run --rm ${FULL_IMAGE} --version
```

---

### 5. Build and Publish Helm Chart

Package the Helm chart and publish to the gh-pages branch.

#### 5.1 Package Helm Chart

```bash
# Change to charts directory
cd charts/mongodb-operator

# Package the chart
helm package .

# This creates: mongodb-operator-1.0.0.tgz
ls -lh *.tgz
cd ../..
```

#### 5.2 Publish to gh-pages Branch

```bash
# Clone gh-pages branch to temporary directory
git clone --branch gh-pages https://github.com/eightynine01/mongodb-operator.git gh-pages-temp
cd gh-pages-temp

# Copy new chart package
cp ../charts/mongodb-operator/mongodb-operator-1.0.0.tgz .

# Update Helm repository index
helm repo index . --url https://eightynine01.github.io/mongodb-operator

# Commit and push
git add mongodb-operator-1.0.0.tgz index.yaml
git commit -m "Publish Helm chart v1.0.0"
git push origin gh-pages

# Cleanup
cd ..
rm -rf gh-pages-temp
```

**Verification:**
```bash
# Verify chart is accessible
curl -s https://eightynine01.github.io/mongodb-operator/index.yaml | grep -A 5 "name: mongodb-operator" | head -20

# Update local Helm repo
helm repo add mongodb-operator https://eightynine01.github.io/mongodb-operator
helm repo update
helm search repo mongodb-operator --versions
```

---

### 6. Build Cross-Platform Binaries

Build binaries for multiple platforms and operating systems.

#### 6.1 Build Binaries

```bash
# Create output directory
mkdir -p dist

# Build for multiple platforms
GOOS=linux GOARCH=amd64 go build -ldflags="-X main.Version=${VERSION}" -o dist/mongodb-operator-linux-amd64
GOOS=linux GOARCH=arm64 go build -ldflags="-X main.Version=${VERSION}" -o dist/mongodb-operator-linux-arm64
GOOS=darwin GOARCH=amd64 go build -ldflags="-X main.Version=${VERSION}" -o dist/mongodb-operator-darwin-amd64
GOOS=darwin GOARCH=arm64 go build -ldflags="-X main.Version=${VERSION}" -o dist/mongodb-operator-darwin-arm64

# Create checksums
cd dist
sha256sum * > checksums.txt
cd ..
```

#### 6.2 Package Binaries

```bash
# Create tar archives
cd dist
for binary in mongodb-operator-*; do
  tar -czf ${binary}.tar.gz ${binary}
done

# List packages
ls -lh *.tar.gz
cd ..
```

**Verification:**
```bash
# Test each binary
for binary in dist/mongodb-operator-*; do
  if [ -f "$binary" ]; then
    echo "Testing $binary..."
    $binary --version || true
  fi
done
```

---

### 7. Create GitHub Release

Use the GitHub UI or CLI to create the official release.

#### Option A: Using GitHub CLI (Recommended)

```bash
# Push tag first
git push origin v1.0.0

# Create release with all artifacts
gh release create v1.0.0 \
  --title "MongoDB Operator v1.0.0 - Initial Stable Release" \
  --notes "See CHANGELOG.md for detailed release notes.

## Highlights

- **Production Ready**: Comprehensive CI/CD, testing, and documentation
- **Enterprise Grade**: Security scanning, SBOM/Provenance, code coverage
- **Easy Installation**: Helm chart available via Helm repository
- **Well Documented**: 9 documentation guides, 7 production examples
- **Automated**: GitHub Actions workflows for all release tasks

## Installation

\`\`\`bash
# Add Helm repository
helm repo add mongodb-operator https://eightynine01.github.io/mongodb-operator
helm repo update

# Install the operator
helm install mongodb-operator mongodb-operator/mongodb-operator \
  --namespace mongodb-operator-system \
  --create-namespace
\`\`\`

## Documentation

- [README](https://github.com/eightynine01/mongodb-operator#readme)
- [Documentation](https://github.com/eightynine01/mongodb-operator/tree/main/docs)
- [Examples](https://github.com/eightynine01/mongodb-operator/tree/main/examples)

## Artifacts

- Docker: \`eightynine01/mongodb-operator:v1.0.0\`
- Helm: \`mongodb-operator/mongodb-operator:1.0.0\`
" \
  dist/mongodb-operator-linux-amd64.tar.gz \
  dist/mongodb-operator-linux-arm64.tar.gz \
  dist/mongodb-operator-darwin-amd64.tar.gz \
  dist/mongodb-operator-darwin-arm64.tar.gz \
  dist/checksums.txt
```

#### Option B: Using GitHub Web UI

1. Navigate to: https://github.com/eightynine01/mongodb-operator/releases/new
2. Select tag: `v1.0.0` (must be pushed first)
3. Release title: `MongoDB Operator v1.0.0 - Initial Stable Release`
4. Description: Copy release notes from CHANGELOG.md
5. Attach binaries from `dist/` directory:
   - `mongodb-operator-linux-amd64.tar.gz`
   - `mongodb-operator-linux-arm64.tar.gz`
   - `mongodb-operator-darwin-amd64.tar.gz`
   - `mongodb-operator-darwin-arm64.tar.gz`
   - `checksums.txt`
6. Check "Set as the latest release"
7. Click "Publish release"

---

### 8. Verification

After creating the release, verify all artifacts.

#### 8.1 Verify Docker Image

```bash
# Pull and test
docker pull eightynine01/mongodb-operator:v1.0.0
docker run --rm eightynine01/mongodb-operator:v1.0.0 --version

# Verify multi-arch support
docker buildx imagetools inspect eightynine01/mongodb-operator:v1.0.0

# Verify latest tag
docker pull ghcr.io/eightynine01/mongodb-operator:latest
docker run --rm ghcr.io/eightynine01/mongodb-operator:latest --version
```

#### 8.2 Verify Helm Chart

```bash
# Install from Helm repo
helm install test-release mongodb-operator/mongodb-operator \
  --namespace test-namespace \
  --create-namespace \
  --dry-run \
  --debug

# Verify chart version
helm show chart mongodb-operator/mongodb-operator | grep version

# Verify chart values
helm show values mongodb-operator/mongodb-operator | head -20
```

#### 8.3 Verify Binaries

```bash
# Download from release
gh release download v1.0.0

# Extract and test
tar -xzf mongodb-operator-linux-amd64.tar.gz
./mongodb-operator-linux-amd64 --version

# Verify checksums
sha256sum -c checksums.txt
```

#### 8.4 Verify GitHub Release

- Open: https://github.com/eightynine01/mongodb-operator/releases/tag/v1.0.0
- Verify release notes display correctly
- Verify all binaries are attached
- Verify release shows as "Latest release"

#### 8.5 Verify Artifact Hub

After ~24 hours, verify chart appears on Artifact Hub:
- https://artifacthub.io/packages/helm/mongodb-operator/mongodb-operator
- Verify version 1.0.0 is listed
- Verify metadata is correct

---

### 9. Post-Release Tasks

After successful release, complete the following tasks:

#### 9.1 Update Documentation

```bash
# Update README.md with v1.0.0 release notes section
# Add after the Quick Start section:
```

### v1.0.0 Release (January 21, 2026)

The initial stable (GA) release is now available! This release includes:

- âœ… Comprehensive CI/CD with 5 GitHub Actions workflows
- âœ… Production-ready documentation (9 guides)
- âœ… Tested examples (7 configurations)
- âœ… Security scanning and SBOM/Provenance
- âœ… Helm chart published to Helm repository
- âœ… Artifact Hub integration

See the [v1.0.0 release notes](https://github.com/eightynine01/mongodb-operator/releases/tag/v1.0.0) for full details.

```

#### 9.2 Update Notepads

Document learnings and decisions from the release process:

```bash
# Add to .sisyphus/notepads/open-source-deployment/learnings.md
# Add to .sisyphus/notepads/open-source-deployment/decisions.md
```

#### 9.3 Announce Release

Share the release with the community:

- **GitHub Discussions**: Create announcement discussion
- **Twitter/X**: Post release announcement
- **Reddit**: Share in r/kubernetes, r/golang
- **LinkedIn**: Post to company profile
- **Email**: Send to mailing list (if applicable)

**Example Announcement:**
```
ðŸŽ‰ MongoDB Operator v1.0.0 - Initial Stable Release!

We're excited to announce the first stable release of the MongoDB Operator for Kubernetes!

Features:
- MongoDB ReplicaSet & Sharded Cluster management
- Automatic initialization and scaling
- TLS encryption with cert-manager
- Prometheus monitoring integration
- S3 backup support
- Comprehensive CI/CD & documentation

Installation:
helm install mongodb-operator mongodb-operator/mongodb-operator --namespace mongodb-operator-system --create-namespace

Learn more: https://github.com/eightynine01/mongodb-operator/releases/tag/v1.0.0

#kubernetes #mongodb #operator
```

#### 9.4 Update Project Roadmap

Update the roadmap in README.md:

```markdown
## Roadmap

### Completed âœ…
- [x] Automatic ReplicaSet initialization
- [x] Automatic Sharded Cluster initialization
- [x] Horizontal shard scaling (scale out)
- [x] Admin user auto-creation
- [x] Comprehensive CI/CD infrastructure
- [x] Production documentation and examples

### Planned ðŸš§
- [ ] Point-in-Time Recovery (PITR)
- [ ] Automated version upgrades
- [ ] Cross-cluster replication
- [ ] Grafana dashboard templates
- [ ] Backup scheduling with CronJob
- [ ] Scale down with data migration
```

#### 9.5 Monitor for Issues

After release, monitor:

- GitHub Issues: Watch for bug reports
- GitHub Discussions: Answer questions
- Helm downloads: Monitor usage metrics
- Docker Hub pulls: Track image downloads
- Artifact Hub: Monitor chart installations

---

## Troubleshooting

### Docker Build Fails

**Issue**: Multi-architecture build fails

**Solution**:
```bash
# Ensure buildx is enabled
docker buildx version

# Create and use new builder
docker buildx create --use

# Enable QEMU for multi-arch builds
docker run --privileged --rm tonistiigi/binfmt --install all
```

### Helm Chart Index Fails

**Issue**: `helm repo index` fails

**Solution**:
```bash
# Ensure index.yaml exists
touch index.yaml

# Rebuild index with force update
helm repo index . --url https://eightynine01.github.io/mongodb-operator --merge index.yaml
```

### Git Tag Already Exists

**Issue**: Tag already exists from previous attempt

**Solution**:
```bash
# Delete local tag
git tag -d v1.0.0

# Delete remote tag
git push origin :refs/tags/v1.0.0

# Recreate tag
git tag -a v1.0.0 -m "Initial stable release v1.0.0"
```

### Binary Build Fails

**Issue**: Go build fails for specific platform

**Solution**:
```bash
# Check Go version
go version

# Ensure CGO is disabled for cross-compilation
export CGO_ENABLED=0

# Test build for single platform
GOOS=linux GOARCH=amd64 go build -o test-binary .
```

### Artifact Hub Not Updating

**Issue**: Chart not appearing on Artifact Hub

**Solution**:
```bash
# Verify Artifact Hub annotations in Chart.yaml
grep -A 10 "artifacthub.io" charts/mongodb-operator/Chart.yaml

# Manually trigger Artifact Hub update
# Visit: https://artifacthub.io/packages/helm/mongodb-operator/mongodb-operator
# Click "More actions" â†’ "Check for updates"
```

---

## Future Releases

After v1.0.0, follow semantic versioning:

### Minor Releases (1.x.0)

New features, enhancements, or improvements without breaking changes.

**Example: v1.1.0**
- Add automated version upgrades
- Add Grafana dashboard templates

### Patch Releases (1.0.x)

Bug fixes, security patches, or non-breaking improvements.

**Example: v1.0.1**
- Fix issue with ReplicaSet scale-out
- Update MongoDB base image version

### Major Releases (x.0.0)

Breaking changes or significant new functionality.

**Example: v2.0.0**
- Require Kubernetes 1.30+
- Change CRD API version to v1beta1
- Deprecate old authentication methods

### Release Process for Future Versions

Follow this same guide with adjustments:

1. **Increment version** in Chart.yaml and CHANGELOG
2. **Update CHANGELOG** with new features/fixes
3. **Create new tag** (e.g., v1.1.0)
4. **Build and push** new Docker images
5. **Package and publish** new Helm chart
6. **Build binaries** for new version
7. **Create GitHub release** with new artifacts

---

## Appendix

### A. Environment Variables

```bash
# Version
export VERSION=v1.0.0

# Docker Registry
export REGISTRY=eightynine01
export IMAGE_NAME=mongodb-operator

# Paths
export CHART_DIR=charts/mongodb-operator
export DIST_DIR=dist
```

### B. Useful Commands

```bash
# Show all tags
git tag -l

# Show tag details
git show v1.0.0

# Compare versions
git diff v0.0.7 v1.0.0

# List Docker images
docker images | grep mongodb-operator

# Search Helm repos
helm search repo mongodb-operator

# Download release assets
gh release download v1.0.0

# View release info
gh release view v1.0.0
```

### C. Release Timeline

| Step | Duration | Notes |
|------|----------|-------|
| Pre-release checks | 1-2 hours | Testing, verification |
| Docker build | 5-10 minutes | Multi-arch |
| Helm chart package | 1-2 minutes | Quick |
| Binary builds | 2-5 minutes | Cross-platform |
| GitHub release | 5 minutes | Manual verification |
| Post-release tasks | 30-60 minutes | Documentation, announcements |
| **Total** | **~2-3 hours** | Excluding verification testing |

### D. Contact & Support

For questions or issues during the release process:

- **GitHub Issues**: https://github.com/eightynine01/mongodb-operator/issues
- **GitHub Discussions**: https://github.com/eightynine01/mongodb-operator/discussions
- **Documentation**: https://github.com/eightynine01/mongodb-operator/tree/main/docs

---

## References

- [Semantic Versioning](https://semver.org/)
- [Keep a Changelog](https://keepachangelog.com/)
- [Helm Chart Best Practices](https://helm.sh/docs/topics/charts/)
- [Docker Buildx](https://docs.docker.com/buildx/working-with-buildx/)
- [GitHub Releases](https://docs.github.com/en/repositories/releasing-projects-on-github)
- [Artifact Hub](https://artifacthub.io/docs/topics/publishing-a-package/)

---

**Document Version**: 1.0.0
**Last Updated**: January 21, 2026
**Maintainer**: MongoDB Operator Team
